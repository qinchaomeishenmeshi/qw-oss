"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
exports.simpleUpload = simpleUpload;
var _enum = require("../enum");
var _file2Hash = require("./file-2-hash");
var _getOssClient = require("./get-oss-client");
const defaultMultipartUploadParams = {
  dir: _enum.OssDirEnum.DEFAULT
};
async function simpleUpload(file, options = defaultMultipartUploadParams) {
  const {
    dir
  } = {
    ...defaultMultipartUploadParams,
    ...options
  };
  const client = await (0, _getOssClient.getOssClient)();
  const ossKey = await (0, _file2Hash.file2OssName)(file, {
    dir
  });
  // console.log(client)
  // console.log(Object.keys(client))
  const res = await client.put(`${ossKey}`, file, {
    headers: {
      // 指定该Object被下载时的内容编码格式。
      "Content-Encoding": "UTF-8"
    }
  });
  const result = {
    ...res,
    fileName: file.name
  };
  console.log(result);
  // console.log(client.signatureUrl(res.name))
  return result;
}
var _default = simpleUpload;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZWZhdWx0TXVsdGlwYXJ0VXBsb2FkUGFyYW1zIiwiZGlyIiwiT3NzRGlyRW51bSIsIkRFRkFVTFQiLCJzaW1wbGVVcGxvYWQiLCJmaWxlIiwib3B0aW9ucyIsImNsaWVudCIsImdldE9zc0NsaWVudCIsIm9zc0tleSIsImZpbGUyT3NzTmFtZSIsInJlcyIsInB1dCIsImhlYWRlcnMiLCJyZXN1bHQiLCJmaWxlTmFtZSIsIm5hbWUiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZXMiOlsiLi4vLi4vbGliU3JjL3NyYy9zaW1wbGUtdXBsb2FkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9zc0RpckVudW0gfSBmcm9tIFwiLi4vZW51bVwiO1xuaW1wb3J0IHsgZmlsZTJPc3NOYW1lIH0gZnJvbSBcIi4vZmlsZS0yLWhhc2hcIjtcbmltcG9ydCB7IGdldE9zc0NsaWVudCB9IGZyb20gXCIuL2dldC1vc3MtY2xpZW50XCI7XG5cbmV4cG9ydCB0eXBlIE9zc1VwbG9hZFJlc3BvbnNlID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xufTtcblxudHlwZSBTaW1wbGVVcGxvYWRQYXJhbXMgPSBQYXJ0aWFsPHR5cGVvZiBkZWZhdWx0TXVsdGlwYXJ0VXBsb2FkUGFyYW1zPjtcbmNvbnN0IGRlZmF1bHRNdWx0aXBhcnRVcGxvYWRQYXJhbXMgPSB7XG4gIGRpcjogT3NzRGlyRW51bS5ERUZBVUxULFxufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpbXBsZVVwbG9hZChcbiAgZmlsZTogRmlsZSxcbiAgb3B0aW9uczogU2ltcGxlVXBsb2FkUGFyYW1zID0gZGVmYXVsdE11bHRpcGFydFVwbG9hZFBhcmFtc1xuKSB7XG4gIGNvbnN0IHsgZGlyIH0gPSB7XG4gICAgLi4uZGVmYXVsdE11bHRpcGFydFVwbG9hZFBhcmFtcyxcbiAgICAuLi5vcHRpb25zLFxuICB9O1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBnZXRPc3NDbGllbnQoKTtcbiAgY29uc3Qgb3NzS2V5ID0gYXdhaXQgZmlsZTJPc3NOYW1lKGZpbGUsIHtcbiAgICBkaXIsXG4gIH0pO1xuICAvLyBjb25zb2xlLmxvZyhjbGllbnQpXG4gIC8vIGNvbnNvbGUubG9nKE9iamVjdC5rZXlzKGNsaWVudCkpXG4gIGNvbnN0IHJlczogT3NzVXBsb2FkUmVzcG9uc2UgPSBhd2FpdCBjbGllbnQucHV0KGAke29zc0tleX1gLCBmaWxlLCB7XG4gICAgaGVhZGVyczoge1xuICAgICAgLy8g5oyH5a6a6K+lT2JqZWN06KKr5LiL6L295pe255qE5YaF5a6557yW56CB5qC85byP44CCXG4gICAgICBcIkNvbnRlbnQtRW5jb2RpbmdcIjogXCJVVEYtOFwiLFxuICAgIH0sXG4gIH0pO1xuICBjb25zdCByZXN1bHQgPSB7XG4gICAgLi4ucmVzLFxuICAgIGZpbGVOYW1lOmZpbGUubmFtZVxuICB9XG4gIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gIC8vIGNvbnNvbGUubG9nKGNsaWVudC5zaWduYXR1cmVVcmwocmVzLm5hbWUpKVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBzaW1wbGVVcGxvYWQ7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFRQSxNQUFNQSw0QkFBNEIsR0FBRztFQUNuQ0MsR0FBRyxFQUFFQyxnQkFBVSxDQUFDQztBQUNsQixDQUFDO0FBRU0sZUFBZUMsWUFBWSxDQUNoQ0MsSUFBVSxFQUNWQyxPQUEyQixHQUFHTiw0QkFBNEIsRUFDMUQ7RUFDQSxNQUFNO0lBQUVDO0VBQUksQ0FBQyxHQUFHO0lBQ2QsR0FBR0QsNEJBQTRCO0lBQy9CLEdBQUdNO0VBQ0wsQ0FBQztFQUNELE1BQU1DLE1BQU0sR0FBRyxNQUFNLElBQUFDLDBCQUFZLEdBQUU7RUFDbkMsTUFBTUMsTUFBTSxHQUFHLE1BQU0sSUFBQUMsdUJBQVksRUFBQ0wsSUFBSSxFQUFFO0lBQ3RDSjtFQUNGLENBQUMsQ0FBQztFQUNGO0VBQ0E7RUFDQSxNQUFNVSxHQUFzQixHQUFHLE1BQU1KLE1BQU0sQ0FBQ0ssR0FBRyxDQUFFLEdBQUVILE1BQU8sRUFBQyxFQUFFSixJQUFJLEVBQUU7SUFDakVRLE9BQU8sRUFBRTtNQUNQO01BQ0Esa0JBQWtCLEVBQUU7SUFDdEI7RUFDRixDQUFDLENBQUM7RUFDRixNQUFNQyxNQUFNLEdBQUc7SUFDYixHQUFHSCxHQUFHO0lBQ05JLFFBQVEsRUFBQ1YsSUFBSSxDQUFDVztFQUNoQixDQUFDO0VBQ0RDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSixNQUFNLENBQUM7RUFDbkI7RUFDQSxPQUFPQSxNQUFNO0FBQ2Y7QUFBQyxlQUVjVixZQUFZO0FBQUEifQ==